apiVersion: v1
kind: ConfigMap
metadata:
  name: fakeoffice-discovery
  namespace: ocis
data:
  hosting-discovery.xml: |
    <wopi-discovery>
        <net-zone name="external-http">
            <app favIconUrl="https://fakeoffice.owncloud.test/favicon.ico" name="wopitest">
                <action default="true" ext="wopitest" name="view" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="wopitest" name="edit" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="odt" name="view" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="odt" name="edit" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="ods" name="view" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="ods" name="edit" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="odp" name="view" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="odp" name="edit" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="txt" name="view" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="txt" name="edit" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="docx" name="view" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="docx" name="edit" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="xlsx" name="view" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="xlsx" name="edit" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="pptx" name="view" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
                <action default="true" ext="pptx" name="edit" urlsrc="https://fakeoffice.owncloud.test/not/relevant?"/>
            </app>
        </net-zone>
    </wopi-discovery>
  serve-discovery.sh: |
    #!/bin/sh
    while true; do
      echo -e "HTTP/1.1 200 OK\nContent-Type: text/xml\n\n$(cat /config/hosting-discovery.xml)" | nc -l -k -p 8080
    done
